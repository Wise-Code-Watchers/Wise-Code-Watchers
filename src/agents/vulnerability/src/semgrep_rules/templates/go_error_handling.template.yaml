rules:
  - id: go-error-ignored-{{SYMBOL}}
    languages: [go]
    severity: WARNING
    message: "Error from {{SYMBOL}} is ignored"
    patterns:
      - pattern: $RES, _ = {{SYMBOL}}(...)

  - id: go-error-checked-{{SYMBOL}}
    languages: [go]
    severity: INFO
    message: "Error from {{SYMBOL}} is checked"
    patterns:
      - pattern: |
          $RES, $ERR = {{SYMBOL}}(...)
          if $ERR != nil {
            ...
          }

  - id: go-error-unchecked-{{SYMBOL}}
    languages: [go]
    severity: WARNING
    message: "Return value of {{SYMBOL}} not checked for error"
    patterns:
      - pattern: {{SYMBOL}}(...)
      - pattern-not: $RES, $ERR = {{SYMBOL}}(...)
      - pattern-not: $RES, _ = {{SYMBOL}}(...)
      - pattern-not: $RES = {{SYMBOL}}(...)
