rules:
  - id: rb-eval-usage
    languages: [ruby]
    severity: WARNING
    message: "Usage of eval (potential code injection)"
    patterns:
      - pattern: eval(...)

  - id: rb-instance-eval-usage
    languages: [ruby]
    severity: WARNING
    message: "Usage of instance_eval"
    patterns:
      - pattern: $OBJ.instance_eval(...)

  - id: rb-class-eval-usage
    languages: [ruby]
    severity: WARNING
    message: "Usage of class_eval"
    patterns:
      - pattern: $OBJ.class_eval(...)

  - id: rb-send-usage-{{SYMBOL}}
    languages: [ruby]
    severity: WARNING
    message: "Dynamic method call via send to {{SYMBOL}}"
    patterns:
      - pattern: $OBJ.send(:{{SYMBOL}}, ...)
      - pattern: $OBJ.send("{{SYMBOL}}", ...)
