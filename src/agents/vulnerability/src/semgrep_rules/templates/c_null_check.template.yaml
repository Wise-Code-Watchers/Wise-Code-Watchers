rules:
  - id: c-null-check-{{SYMBOL}}
    languages: [c]
    severity: INFO
    message: "Null check for {{SYMBOL}}"
    patterns:
      - pattern: |
          if ({{SYMBOL}} == NULL) {
            ...
          }
      - pattern: |
          if ({{SYMBOL}} != NULL) {
            ...
          }
      - pattern: |
          if (!{{SYMBOL}}) {
            ...
          }

  - id: c-deref-without-null-check-{{SYMBOL}}
    languages: [c]
    severity: WARNING
    message: "Dereference of {{SYMBOL}} without null check"
    patterns:
      - pattern: "*{{SYMBOL}}"
      - pattern-not-inside: |
          if ({{SYMBOL}} != NULL) {
            ...
          }
      - pattern-not-inside: |
          if ({{SYMBOL}}) {
            ...
          }
