rules:
  - id: c-malloc-{{SYMBOL}}
    languages: [c]
    severity: WARNING
    message: "Memory allocation for {{SYMBOL}}"
    patterns:
      - pattern: $PTR = malloc(...)

  - id: c-free-{{SYMBOL}}
    languages: [c]
    severity: WARNING
    message: "Memory free of {{SYMBOL}}"
    patterns:
      - pattern: free({{SYMBOL}})

  - id: c-malloc-no-free-{{SYMBOL}}
    languages: [c]
    severity: WARNING
    message: "malloc without corresponding free for {{SYMBOL}}"
    patterns:
      - pattern: |
          $FUNC(...) {
            ...
            {{SYMBOL}} = malloc(...)
            ...
          }
      - pattern-not: |
          $FUNC(...) {
            ...
            {{SYMBOL}} = malloc(...)
            ...
            free({{SYMBOL}})
            ...
          }

  - id: c-realloc-{{SYMBOL}}
    languages: [c]
    severity: WARNING
    message: "Memory reallocation of {{SYMBOL}}"
    patterns:
      - pattern: {{SYMBOL}} = realloc({{SYMBOL}}, ...)
