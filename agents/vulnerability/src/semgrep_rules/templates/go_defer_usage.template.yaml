rules:
  - id: go-defer-{{SYMBOL}}
    languages: [go]
    severity: WARNING
    message: "Deferred call to {{SYMBOL}}"
    patterns:
      - pattern: defer {{SYMBOL}}(...)

  - id: go-missing-defer-{{SYMBOL}}
    languages: [go]
    severity: WARNING
    message: "Call to {{SYMBOL}} without defer"
    patterns:
      - pattern: {{SYMBOL}}(...)
      - pattern-not: defer {{SYMBOL}}(...)
