rules:
  - id: go-goroutine-{{SYMBOL}}
    languages: [go]
    severity: WARNING
    message: "Goroutine spawning {{SYMBOL}}"
    patterns:
      - pattern: go {{SYMBOL}}(...)

  - id: go-goroutine-closure-{{SYMBOL}}
    languages: [go]
    severity: WARNING
    message: "Goroutine with closure calling {{SYMBOL}}"
    patterns:
      - pattern: |
          go func(...) {
            ...
            {{SYMBOL}}(...)
            ...
          }(...)
