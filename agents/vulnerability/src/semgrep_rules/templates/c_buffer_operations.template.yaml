rules:
  - id: c-buffer-access-{{SYMBOL}}
    languages: [c]
    severity: WARNING
    message: "Buffer access on {{SYMBOL}}"
    patterns:
      - pattern: "{{SYMBOL}}[$IDX]"

  - id: c-strcpy-{{SYMBOL}}
    languages: [c]
    severity: WARNING
    message: "strcpy to {{SYMBOL}} (potential buffer overflow)"
    patterns:
      - pattern: strcpy({{SYMBOL}}, ...)

  - id: c-strncpy-{{SYMBOL}}
    languages: [c]
    severity: INFO
    message: "strncpy to {{SYMBOL}}"
    patterns:
      - pattern: strncpy({{SYMBOL}}, ..., ...)

  - id: c-memcpy-{{SYMBOL}}
    languages: [c]
    severity: WARNING
    message: "memcpy involving {{SYMBOL}}"
    patterns:
      - pattern: memcpy({{SYMBOL}}, ..., ...)
      - pattern: memcpy(..., {{SYMBOL}}, ...)

  - id: c-sprintf-{{SYMBOL}}
    languages: [c]
    severity: WARNING
    message: "sprintf to {{SYMBOL}} (potential buffer overflow)"
    patterns:
      - pattern: sprintf({{SYMBOL}}, ...)
